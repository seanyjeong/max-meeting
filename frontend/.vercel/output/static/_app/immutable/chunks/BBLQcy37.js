import{y as i,z as g}from"./dEE0t6TH.js";import{a as l}from"./nFeSIjG2.js";function f(){const{subscribe:c,set:u,update:r}=g({contacts:[],selectedContact:null,isLoading:!1,error:null,searchQuery:"",total:0});return{subscribe:c,async fetchContacts(o,t=50,a=0){r(e=>({...e,isLoading:!0,error:null}));try{const e={limit:t,offset:a};o&&(e.q=o);const s=await l.get("/contacts",e);r(n=>({...n,contacts:s.data,total:s.meta.total,isLoading:!1,searchQuery:o||""}))}catch(e){const s=e instanceof Error?e.message:"Failed to fetch contacts";r(n=>({...n,isLoading:!1,error:s}))}},async fetchContact(o){r(t=>({...t,isLoading:!0,error:null}));try{const t=await l.get(`/contacts/${o}`);return r(a=>({...a,selectedContact:t.data,isLoading:!1})),t.data}catch(t){const a=t instanceof Error?t.message:"Failed to fetch contact";return r(e=>({...e,isLoading:!1,error:a})),null}},async createContact(o){r(t=>({...t,isLoading:!0,error:null}));try{const t=await l.post("/contacts",o);return r(a=>({...a,contacts:[t.data,...a.contacts],total:a.total+1,isLoading:!1})),t.data}catch(t){const a=t instanceof Error?t.message:"Failed to create contact";return r(e=>({...e,isLoading:!1,error:a})),null}},async updateContact(o,t){r(a=>({...a,isLoading:!0,error:null}));try{const a=await l.patch(`/contacts/${o}`,t);return r(e=>{var s;return{...e,contacts:e.contacts.map(n=>n.id===o?a.data:n),selectedContact:((s=e.selectedContact)==null?void 0:s.id)===o?a.data:e.selectedContact,isLoading:!1}}),a.data}catch(a){const e=a instanceof Error?a.message:"Failed to update contact";return r(s=>({...s,isLoading:!1,error:e})),null}},async deleteContact(o){r(t=>({...t,isLoading:!0,error:null}));try{return await l.delete(`/contacts/${o}`),r(t=>{var a;return{...t,contacts:t.contacts.filter(e=>e.id!==o),selectedContact:((a=t.selectedContact)==null?void 0:a.id)===o?null:t.selectedContact,total:t.total-1,isLoading:!1}}),!0}catch(t){const a=t instanceof Error?t.message:"Failed to delete contact";return r(e=>({...e,isLoading:!1,error:a})),!1}},setSelectedContact(o){r(t=>({...t,selectedContact:o}))},clearError(){r(o=>({...o,error:null}))},reset(){u({contacts:[],selectedContact:null,isLoading:!1,error:null,searchQuery:"",total:0})}}}const d=f(),m=i(d,c=>c.contacts),p=i(d,c=>c.selectedContact),h=i(d,c=>c.isLoading),y=i(d,c=>c.error);export{y as a,h as b,d as c,m as d,p as s};
