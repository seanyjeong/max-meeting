# v1.5 Critical Fixes Design

## C1: 세그먼트-안건 매핑 알고리즘 개선

### 현재 로직 (문제)
```python
# backend/workers/tasks/llm.py:180-183
matching = [
    s["text"] for s in all_segs
    if start <= s["start"] < end  # 세그먼트 시작 시간만 확인
]
```

### 개선 로직
```python
# 세그먼트 중간 시간으로 판단
matching = [
    s["text"] for s in all_segs
    if start <= (s["start"] + s["end"]) / 2 < end
]
```

### 수정 파일
- `backend/workers/tasks/llm.py` - `get_agenda_transcript()` 함수

---

## C2: 3레벨 안건 지원

### 백엔드 수정
```python
# backend/app/services/meeting.py:134-138
# 현재: 1단계만 로드
.selectinload(Agenda.children).selectinload(Agenda.questions)

# 개선: 재귀적 로드 (3레벨까지)
.selectinload(Agenda.children)
    .selectinload(Agenda.questions)
.selectinload(Agenda.children)
    .selectinload(Agenda.children)
    .selectinload(Agenda.questions)
```

### 프론트엔드 수정
- `AgendaNotePanel.svelte` - 재귀 렌더링 추가
- `ResultsDiscussionList.svelte` - 3레벨 표시

---

## I1: 질문 생성 기능

### API
- `POST /api/v1/agendas/{agenda_id}/questions` (기존 API 활용)

### UI
- 안건 상세에 "질문 추가" 버튼
- 간단한 입력 폼

---

## I3: 하위 안건 박스 크기 확대

### 수정 파일
- `ResultsDiscussionList.svelte` - 하위 안건 카드 크기 증가

---

## E1: 가로모드 강제

### 방법
```svelte
<svelte:head>
  <meta name="screen-orientation" content="landscape">
</svelte:head>

<script>
  // screen.orientation.lock('landscape') - 필요시
</script>
```
